

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Titanic Dataset Analysis &mdash; bnlearn bnlearn documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=e0179649" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=441dd29d"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="bnlearn.structure_learning" href="bnlearn.structure_learning.html" />
    <link rel="prev" title="Examples" href="Examples.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            bnlearn
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Quickstart</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Quickstart.html">Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Discretizing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Discretizing.html">Discretizing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Discretizing.html#manual-discretization">Manual Discretization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Discretizing.html#automatic-discretization-probability-density">Automatic Discretization: Probability Density</a></li>
<li class="toctree-l1"><a class="reference internal" href="Discretizing.html#automatic-discretization-principled-bayesian">Automatic Discretization: Principled Bayesian</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Structure learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html">Causation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html#exhaustivesearch">Exhaustivesearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html#hillclimbsearch">Hillclimbsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html#chow-liu">Chow-liu</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html#tree-augmented-naive-bayes-tan">Tree-augmented Naive Bayes (TAN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html#naivebayes">NaiveBayes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html#constraint-based">Constraint-based</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parameter learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Parameter%20learning.html">Parameter learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Parameter%20learning.html#parameter-learning-examples">Parameter Learning Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="Parameter%20learning.html#conditional-probability-distributions-cpd">Conditional Probability Distributions (CPD)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Inference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Inference.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="Inference.html#inference-algorithms">Inference Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="Inference.html#examples-inference">Examples Inference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Continuous Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Continuous%20Data.html">Modelling Continuous Datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Predict</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Predict.html">Predict</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Generate Synthetic Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Sampling.html">Forward Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sampling.html#gibbs-sampling">Gibbs Sampling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Plot</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Plot.html">Plotting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other functionalities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="independence_test.html">Independence test</a></li>
<li class="toctree-l1"><a class="reference internal" href="Create%20DAG.html">Directed Acyclic Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="impute.html">Impute</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example%20Datasets.html">DataFrames</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example%20Datasets.html#import-dag-bif">Import DAG/BIF</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example%20Datasets.html#export-dag-bif">Export DAG/BIF</a></li>
<li class="toctree-l1"><a class="reference internal" href="whitelist_blacklist.html">Black and white lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="topological_sort.html">Topological sort</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataframe%20conversions.html">Data Conversions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure_scores.html">Structure Scores</a></li>
<li class="toctree-l1"><a class="reference internal" href="saving%20and%20loading.html">Saving and Loading</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html#working-with-raw-data">Working with Raw Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html#create-a-bayesian-network-learn-its-parameters-from-data-and-perform-the-inference">Create a Bayesian Network, learn its parameters from data and perform the inference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Use Cases</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Titanic Dataset Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="#medical-domain-analysis">Medical Domain Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="#importing-data">Importing Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#making-inferences-with-data-and-expert-knowledge">Making Inferences with Data and Expert Knowledge</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-custom-directed-acyclic-graph">Creating a Custom Directed Acyclic Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="#computing-conditional-probability-distributions-cpds">Computing Conditional Probability Distributions (CPDs)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#make-inferences">Make inferences</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#determine-causalities-when-you-have-data">Determine causalities when you have data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#compute-directed-acyclic-graph-from-data">Compute Directed Acyclic Graph from data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#make-inference-when-you-have-data">Make inference when you have data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#use-case-continuous-datasets">Use Case Continuous Datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parameters and attributes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="bnlearn.structure_learning.html">bnlearn.structure_learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="bnlearn.parameter_learning.html">bnlearn.parameter_learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="bnlearn.inference.html">bnlearn.inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="bnlearn.bnlearn.html">bnlearn.bnlearn</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html">Documentation</a></li>
</ul>

    <a href= "genindex.html">Index</a>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">bnlearn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Titanic Dataset Analysis</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/UseCases.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="titanic-dataset-analysis">
<h1>Titanic Dataset Analysis<a class="headerlink" href="#titanic-dataset-analysis" title="Link to this heading"></a></h1>
<p>In this example, we will learn the structure of the Titanic dataset.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">bnlearn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">bn</span>

<span class="c1"># Load example mixed dataset</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">import_example</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;titanic&#39;</span><span class="p">)</span>

<span class="c1"># Convert to one-hot encoding</span>
<span class="n">dfhot</span><span class="p">,</span> <span class="n">dfnum</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">df2onehot</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Structure learning</span>
<span class="c1"># model = bn.structure_learning.fit(dfnum, methodtype=&#39;cl&#39;, black_list=[&#39;Embarked&#39;,&#39;Parch&#39;,&#39;Name&#39;], root_node=&#39;Survived&#39;, bw_list_method=&#39;nodes&#39;)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">structure_learning</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dfnum</span><span class="p">)</span>
<span class="c1"># Plot</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Compute edge strength with chi-square test statistic</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">independence_test</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dfnum</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="s1">&#39;chi_square&#39;</span><span class="p">,</span> <span class="n">prune</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Plot with edge labels</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="s1">&#39;pos&#39;</span><span class="p">],</span> <span class="n">edge_labels</span><span class="o">=</span><span class="s1">&#39;pvalue&#39;</span><span class="p">)</span>

<span class="c1"># Parameter learning</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">parameter_learning</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dfnum</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils align-center" id="id1">
<caption><span class="caption-text">Learned structure on the Titanic dataset</span><a class="headerlink" href="#id1" title="Link to this table"></a></caption>
<tbody>
<tr class="row-odd"><td><p><img alt="fig_t1" src="_images/titanic_dag.png" /></p></td>
</tr>
<tr class="row-even"><td><p><img alt="fig_t2" src="_images/titanic_dag_chi2.png" /></p></td>
</tr>
</tbody>
</table>
<p>Making Inferences:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make inference with evidence</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">inference</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Sex&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;Pclass&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

<span class="c1"># +----+------------+----------+</span>
<span class="c1"># |    |   Survived |        p |</span>
<span class="c1"># +====+============+==========+</span>
<span class="c1"># |  0 |          0 | 0.555427 |</span>
<span class="c1"># +----+------------+----------+</span>
<span class="c1"># |  1 |          1 | 0.444573 |</span>
<span class="c1"># +----+------------+----------+</span>

<span class="nb">print</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
<span class="c1">#  Survived         p</span>
<span class="c1">#  0        0.555427</span>
<span class="c1">#  1        0.444573</span>

<span class="c1"># Another inference using only sex as evidence</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">inference</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Sex&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="c1"># +----+------------+----------+</span>
<span class="c1"># |    |   Survived |        p |</span>
<span class="c1"># +====+============+==========+</span>
<span class="c1"># |  0 |          0 | 0.406634 |</span>
<span class="c1"># +----+------------+----------+</span>
<span class="c1"># |  1 |          1 | 0.593366 |</span>
<span class="c1"># +----+------------+----------+</span>

<span class="nb">print</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Print model CPDs</span>
<span class="n">CPDs</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">print_CPD</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="c1"># All CPDs are stored in the dict CPD which contains the CPD for each node</span>
<span class="nb">print</span><span class="p">(</span><span class="n">CPDs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="c1"># dict_keys([&#39;Pclass&#39;, &#39;Survived&#39;, &#39;Embarked&#39;, &#39;Sex&#39;, &#39;SibSp&#39;, &#39;Parch&#39;])</span>

<span class="n">CPDs</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span>
<span class="c1">#     Survived  Pclass  Sex         p</span>
<span class="c1"># 0          0       0    0  0.331202</span>
<span class="c1"># 1          0       0    1  0.555427</span>
<span class="c1"># 2          0       1    0  0.368132</span>
<span class="c1"># 3          0       1    1  0.634709</span>
<span class="c1"># 4          0       2    0  0.500000</span>
<span class="c1"># 5          0       2    1  0.746269</span>
<span class="c1"># 6          1       0    0  0.668798</span>
<span class="c1"># 7          1       0    1  0.444573</span>
<span class="c1"># 8          1       1    0  0.631868</span>
<span class="c1"># 9          1       1    1  0.365291</span>
<span class="c1"># 10         1       2    0  0.500000</span>
<span class="c1"># 11         1       2    1  0.253731</span>
</pre></div>
</div>
</section>
<section id="medical-domain-analysis">
<h1>Medical Domain Analysis<a class="headerlink" href="#medical-domain-analysis" title="Link to this heading"></a></h1>
<p>This section describes a use case for analyzing patient treatment regarding shortness-of-breath (dyspnea). The example demonstrates how to incorporate expert knowledge into a Bayesian model. The dataset is synthetic and based on Lauritzen and Spiegelhalter (1988), focusing on lung diseases (tuberculosis, lung cancer, or bronchitis) and visits to Asia.</p>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>Motivation:</dt><dd><p>“<em>Shortness-of-breath (dyspnea) may be due to tuberculosis, lung cancer or bronchitis, or none of them, or more than one of them. A recent visit to Asia increases the chances of tuberculosis, while smoking is known to be a risk factor for both lung cancer and bronchitis. The results of a single chest X-ray do not discriminate between lung cancer and tuberculosis, as neither does the presence or absence of dyspnea.</em>”</p>
</dd>
<dt>Source:</dt><dd><p><em>Lauritzen S, Spiegelhalter D (1988). Local Computation with Probabilities on Graphical Structures and their Application to Expert Systems (with discussion). Journal of the Royal Statistical Society</em></p>
</dd>
</dl>
</section>
<section id="importing-data">
<h2>Importing Data<a class="headerlink" href="#importing-data" title="Link to this heading"></a></h2>
<p>The first step is to import the dataset. For unstructured data, use the <code class="docutils literal notranslate"><span class="pre">df2onehot</span></code> functionality <a class="reference internal" href="bnlearn.bnlearn.html#bnlearn.bnlearn.df2onehot" title="bnlearn.bnlearn.df2onehot"><code class="xref py py-func docutils literal notranslate"><span class="pre">bnlearn.bnlearn.df2onehot()</span></code></a>. The <strong>Examples</strong> section contains examples of importing raw data followed by basic structuring approaches (section: <a class="reference internal" href="Examples.html#working-with-raw-data"><span class="std std-ref">Working with Raw Data</span></a>). In this case, we’ll load a structured dataset from <code class="docutils literal notranslate"><span class="pre">bnlearn</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">bnlearn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">bn</span>
<span class="c1"># Load dataset with 10,000 samples</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">import_example</span><span class="p">(</span><span class="s1">&#39;asia&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="c1"># Print to screen</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>smoke</p></th>
<th class="head"><p>bronc</p></th>
<th class="head"><p>lung</p></th>
<th class="head"><p>asia</p></th>
<th class="head"><p>tub</p></th>
<th class="head"><p>either</p></th>
<th class="head"><p>dysp</p></th>
<th class="head"><p>xray</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-even"><td><p>9999</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p>This dataset contains 8 variables with discrete values (yes/no, true/false, or 1/0). <code class="docutils literal notranslate"><span class="pre">bnlearn</span></code> can handle multiple categories, including non-numerical values (see <a class="reference internal" href="Examples.html#working-with-raw-data"><span class="std std-ref">Working with Raw Data</span></a>). In this example, we generate 10,000 samples representing patients. The number of required samples depends on the dataset’s complexity (number of variables and categories per variable). For example, 1,000 samples are sufficient for the <strong>sprinkler</strong> dataset (4 variables, binary states), while more complex datasets like <strong>alarm</strong> require more samples.</p>
</section>
<section id="making-inferences-with-data-and-expert-knowledge">
<h2>Making Inferences with Data and Expert Knowledge<a class="headerlink" href="#making-inferences-with-data-and-expert-knowledge" title="Link to this heading"></a></h2>
<p>Expert knowledge can be incorporated into Bayesian models using Directed Acyclic Graphs. The DAG describes relationships between variables. Let’s create a custom DAG and make inferences (<a class="reference internal" href="Inference.html#inference"><span class="std std-ref">Inference</span></a>).</p>
<dl class="simple">
<dt>Aim: Make inferences about shortness-of-breath (dyspnea) when:</dt><dd><ol class="arabic simple">
<li><p>You have measured data (imported as shown in <a class="reference internal" href="Example%20Datasets.html#import-dag-bif"><span class="std std-ref">Import DAG/BIF</span></a>)</p></li>
<li><p>You have expert knowledge</p></li>
</ol>
</dd>
</dl>
<section id="creating-a-custom-directed-acyclic-graph">
<h3>Creating a Custom Directed Acyclic Graph<a class="headerlink" href="#creating-a-custom-directed-acyclic-graph" title="Link to this heading"></a></h3>
<p>Based on limited knowledge about dyspnea:
- Smoking is related to lung cancer
- Smoking is related to bronchitis
- Lung conditions or bronchitis may require an X-ray examination</p>
<p>This is a simple DAG for demonstration purposes. Note that the direction is crucial - the first column is the source (“from”) and the second column is the destination (“to”).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">edges</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;smoke&#39;</span><span class="p">,</span> <span class="s1">&#39;lung&#39;</span><span class="p">),</span>
         <span class="p">(</span><span class="s1">&#39;smoke&#39;</span><span class="p">,</span> <span class="s1">&#39;bronc&#39;</span><span class="p">),</span>
         <span class="p">(</span><span class="s1">&#39;lung&#39;</span><span class="p">,</span> <span class="s1">&#39;xray&#39;</span><span class="p">),</span>
         <span class="p">(</span><span class="s1">&#39;bronc&#39;</span><span class="p">,</span> <span class="s1">&#39;xray&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p>Plot the Bayesian DAG:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the DAG from the edges</span>
<span class="n">DAG</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">make_DAG</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>

<span class="c1"># Plot and verify the arrows are correct</span>
<span class="n">bn</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">DAG</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="fig-lung-simple-dag">
<img alt="_images/lung_simple_dag.png" src="_images/lung_simple_dag.png" />
</figure>
</section>
<section id="computing-conditional-probability-distributions-cpds">
<h3>Computing Conditional Probability Distributions (CPDs)<a class="headerlink" href="#computing-conditional-probability-distributions-cpds" title="Link to this heading"></a></h3>
<p>We now have:
1. The dataset in our dataframe (df)
2. The DAG based on expert knowledge</p>
<p>The next step is to connect the DAG to the dataset using <code class="xref py py-func docutils literal notranslate"><span class="pre">bnlearn.bnlearn.parameter_learning.fit()</span></code>, which computes the CPDs. See section <a class="reference internal" href="Parameter%20learning.html#parameter-learning"><span class="std std-ref">Parameter learning</span></a> for more details about CPDs and parameter learning.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check current CPDs in the DAG</span>
<span class="n">CPDs</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">print_CPD</span><span class="p">(</span><span class="n">DAG</span><span class="p">)</span>
<span class="c1"># [bnlearn] &gt;No CPDs to print. Tip: use bn.plot(DAG) to make a plot.</span>
<span class="c1"># This is correct, as we haven&#39;t specified any CPDs yet</span>

<span class="c1"># Learn parameters from the dataset</span>
<span class="n">DAG</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">parameter_learning</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">DAG</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">methodtype</span><span class="o">=</span><span class="s1">&#39;bayes&#39;</span><span class="p">)</span>

<span class="c1"># Print the CPDs</span>
<span class="n">CPDs</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">print_CPD</span><span class="p">(</span><span class="n">DAG</span><span class="p">)</span>
<span class="c1"># Now we have a DAG with learned CPDs</span>
</pre></div>
</div>
<p>The learned Conditional Probability Distributions are shown in the tables below. For example:
- The probability that a patient does not smoke is P(smoke=0)=0.49
- The probability that a patient smokes is P(smoke=1)=0.50</p>
<p>CPD of smoke:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>smoke(0)</p></td>
<td><p>0.495273</p></td>
</tr>
<tr class="row-even"><td><p>smoke(1)</p></td>
<td><p>0.504727</p></td>
</tr>
</tbody>
</table>
<p>The CPD becomes more complex for patients who smoke and have lung cancer (intersection). More edges to a node increase complexity, but <code class="docutils literal notranslate"><span class="pre">bnlearn</span></code> handles the computations.</p>
<p>CPD of lung:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>smoke</p></td>
<td><p>smoke(0)</p></td>
<td><p>smoke(1)</p></td>
</tr>
<tr class="row-even"><td><p>lung(0)</p></td>
<td><p>0.13913362701908957</p></td>
<td><p>0.05457492795389049</p></td>
</tr>
<tr class="row-odd"><td><p>lung(1)</p></td>
<td><p>0.8608663729809104</p></td>
<td><p>0.9454250720461095</p></td>
</tr>
</tbody>
</table>
<p>CPD of bronc:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>smoke</p></td>
<td><p>smoke(0)</p></td>
<td><p>smoke(1)</p></td>
</tr>
<tr class="row-even"><td><p>bronc(0)</p></td>
<td><p>0.5936123348017621</p></td>
<td><p>0.3114193083573487</p></td>
</tr>
<tr class="row-odd"><td><p>bronc(1)</p></td>
<td><p>0.4063876651982379</p></td>
<td><p>0.6885806916426513</p></td>
</tr>
</tbody>
</table>
<p>CPD of xray:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>bronc</p></td>
<td><p>bronc(0)</p></td>
<td><p>bronc(0)</p></td>
<td><p>bronc(1)</p></td>
<td><p>bronc(1)</p></td>
</tr>
<tr class="row-even"><td><p>lung</p></td>
<td><p>lung(0)</p></td>
<td><p>lung(1)</p></td>
<td><p>lung(0)</p></td>
<td><p>lung(1)</p></td>
</tr>
<tr class="row-odd"><td><p>xray(0)</p></td>
<td><p>0.7651245551601423</p></td>
<td><p>0.08089070665757782</p></td>
<td><p>0.7334669338677354</p></td>
<td><p>0.08396533044420368</p></td>
</tr>
<tr class="row-even"><td><p>xray(1)</p></td>
<td><p>0.23487544483985764</p></td>
<td><p>0.9191092933424222</p></td>
<td><p>0.2665330661322645</p></td>
<td><p>0.9160346695557963</p></td>
</tr>
</tbody>
</table>
</section>
<section id="make-inferences">
<h3>Make inferences<a class="headerlink" href="#make-inferences" title="Link to this heading"></a></h3>
<p>When you are at this part, you combined your expert knowledge with a data set! Now we can make inferences which allows to ask questions to the model. Let me demonstrate a few questions.</p>
<p><strong>Question 1</strong></p>
<p>What is the probability of lung-cancer, given that we know that patient does smoke?
The model returns that the probability of lung-cancer or lung(1) is 0.94 when the patient does smoke; P(lung=1 | smoke=1)=0.94.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">q1</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">inference</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">DAG</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lung&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;smoke&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">q1</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Finding Elimination Order: : 100% 2/2 [00:00&lt;00:00, 401.14it/s]</span>
<span class="c1"># Eliminating: bronc: 100%| 2/2 [00:00&lt;00:00, 200.50it/s]</span>
<span class="c1"># [bnlearn] &gt;Variable Elimination..</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>lung</p></th>
<th class="head"><p>phi(lung)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>lung(0)</p></td>
<td><p>0.0546</p></td>
</tr>
<tr class="row-odd"><td><p>lung(1)</p></td>
<td><p>0.9454</p></td>
</tr>
</tbody>
</table>
<p><strong>Question 2</strong></p>
<p>What is the probability of bronchitis, given that we know that patient does smoke?
The model returns that the probability of bronchitis or bronc(1) is 0.68 when the patient does smoke; P(bronc=1 | smoke=1)=0.68.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">q2</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">inference</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">DAG</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bronc&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;smoke&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>

<span class="c1"># Finding Elimination Order: : 100% 2/2 [00:00&lt;00:00, 286.31it/s]</span>
<span class="c1"># Eliminating: lung: 100% 2/2 [00:00&lt;00:00, 143.26it/s]</span>
<span class="c1"># [bnlearn] &gt;Variable Elimination..</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>bronc</p></th>
<th class="head"><p>phi(bronc)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>bronc(0)</p></td>
<td><p>0.3114</p></td>
</tr>
<tr class="row-odd"><td><p>bronc(1)</p></td>
<td><p>0.6886</p></td>
</tr>
</tbody>
</table>
<p><strong>Question 3</strong></p>
<p>Lets add more information to our inference. What is the probability of lung-cancer, given that we know that patient does smoke and also has bronchitis?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">q3</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">inference</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">DAG</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lung&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;smoke&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;bronc&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>

<span class="c1"># Finding Elimination Order: : 100%  1/1 [00:00&lt;00:00, 334.31it/s]</span>
<span class="c1"># Eliminating: xray: 100%  1/1 [00:00&lt;00:00, 338.47it/s]</span>
<span class="c1"># [bnlearn] &gt;Variable Elimination..</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>lung</p></th>
<th class="head"><p>phi(lung)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>lung(0)</p></td>
<td><p>0.0546</p></td>
</tr>
<tr class="row-odd"><td><p>lung(1)</p></td>
<td><p>0.9454</p></td>
</tr>
</tbody>
</table>
<p><strong>Question 4</strong></p>
<p>Lets specify the question even more. What is the probability of lung-cancer or bronchitis, given that we know that patient does smoke but did not had xray?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">q4</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">inference</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">DAG</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bronc&#39;</span><span class="p">,</span><span class="s1">&#39;lung&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;smoke&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;xray&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>lung</p></th>
<th class="head"><p>bronc</p></th>
<th class="head"><p>phi(lung,bronc)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>lung(0)</p></td>
<td><p>bronc(0)</p></td>
<td><p>0.1092</p></td>
</tr>
<tr class="row-odd"><td><p>lung(0)</p></td>
<td><p>bronc(1)</p></td>
<td><p>0.2315</p></td>
</tr>
<tr class="row-even"><td><p>lung(1)</p></td>
<td><p>bronc(0)</p></td>
<td><p>0.2001</p></td>
</tr>
<tr class="row-odd"><td><p>lung(1)</p></td>
<td><p>bronc(1)</p></td>
<td><p>0.4592</p></td>
</tr>
</tbody>
</table>
<p>The highest probability for the patient under these condition is that lung-cancer is true and bronchitus is true too (P=0.45). Note that, if you put xray=1, then the probability becomes even higher (P=0.67).</p>
<section id="determine-causalities-when-you-have-data">
<h4>Determine causalities when you have data<a class="headerlink" href="#determine-causalities-when-you-have-data" title="Link to this heading"></a></h4>
<p>Suppose that we have the medical records of hundreds or even thousands patients treatment regarding shortness-of-breath (dyspnoea). Our goal is to determine the causality across variables given the data set.</p>
<dl class="simple">
<dt>Steps to take</dt><dd><ol class="arabic simple">
<li><p>Import the data set.</p></li>
<li><p>Compute Directed Acyclic Graph by means of structure learning.</p></li>
<li><p>Compare to DAG to that of the expert-DAG.</p></li>
</ol>
</dd>
</dl>
</section>
</section>
<section id="compute-directed-acyclic-graph-from-data">
<h3>Compute Directed Acyclic Graph from data<a class="headerlink" href="#compute-directed-acyclic-graph-from-data" title="Link to this heading"></a></h3>
<p>Import and process teh data set (<a class="reference internal" href="#importing-data"><span class="std std-ref">Importing Data</span></a>). For this use-case we will compute the best performing DAG given the data set. You only need to provide the data set into <code class="docutils literal notranslate"><span class="pre">bnlearn</span></code> <code class="xref py py-func docutils literal notranslate"><span class="pre">bnlearn.bnlearn.structure_learning.fit()</span></code>. More about Directed Acyclic Graphs can be found in the section <a class="reference internal" href="Create%20DAG.html#directed-acyclic-graphs"><span class="std std-ref">Directed Acyclic Graphs</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Structure learning on the data set</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">structure_learning</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="c1"># [bnlearn] &gt;Computing best DAG using [hc]</span>
<span class="c1"># [bnlearn] &gt;Set scoring type at [bic]</span>

<span class="c1"># Compute significance</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">independence_test</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">prune</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># [bnlearn] &gt;Edge [lung &lt;-&gt; tub] [P=0.540506] is excluded because it was not significant (P&lt;0.05) with [chi_square]</span>
</pre></div>
</div>
<p>The computations can take seconds to days or even never-ending, depending on the complexity of your data set and the method in <code class="docutils literal notranslate"><span class="pre">bnlearn</span></code> you choose. This use-case contains only 8 variables, each with two states and will be computed within seconds. If your data set is huge, and readily have suspicion you can use the black_list or white_list parameters (<a class="reference internal" href="whitelist_blacklist.html#black-and-white-lists"><span class="std std-ref">Black and white lists</span></a>).</p>
<p>Lets plot the learned DAG and examine the structure!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the DAG</span>
<span class="n">bn</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">bn</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Plot differences between expert-DAG and the computed-DAG</span>
<span class="n">bn</span><span class="o">.</span><span class="n">compare_networks</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">DAG</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="fig-asia-structurelearning">
<img alt="_images/asia_structurelearning.png" src="_images/asia_structurelearning.png" />
</figure>
<p>A comparison with our initial expert-DAG shows few differences in <strong>red</strong>. As an example, we did not include the <em>either</em> variable, which describes either being lung-cancer or bronchitus.</p>
<figure class="align-default" id="fig-asia-dag-vs-model">
<img alt="_images/asia_dag_vs_model.png" src="_images/asia_dag_vs_model.png" />
</figure>
</section>
<section id="make-inference-when-you-have-data">
<h3>Make inference when you have data<a class="headerlink" href="#make-inference-when-you-have-data" title="Link to this heading"></a></h3>
<p>In this scenario we the goal is to make inferences across variables given the data set.</p>
<dl class="simple">
<dt>Steps to take</dt><dd><ol class="arabic simple">
<li><p>Import the data set</p></li>
<li><p>Compute Directed Acyclic Graph (DAG)</p></li>
<li><p>Compute Conditional Probability Distributions (CPDs)</p></li>
</ol>
</dd>
</dl>
<p>The first step is to import and pre-process the data set as depicted in <a class="reference internal" href="#importing-data"><span class="std std-ref">Importing Data</span></a>. Then we compute the DAG by means of structure learning as depicted in <a class="reference internal" href="#compute-directed-acyclic-graph-from-data"><span class="std std-ref">Compute Directed Acyclic Graph from data</span></a>. To make inferences, we first need to compute the CPDs which we can do with <code class="xref py py-func docutils literal notranslate"><span class="pre">bnlearn.bnlearn.parameter_learning.fit()</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Learning the CPDs using parameter learning</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">parameter_learning</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">methodtype</span><span class="o">=</span><span class="s1">&#39;bayes&#39;</span><span class="p">)</span>
<span class="c1"># Print the CPDs</span>
<span class="n">CPDs</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">print_CPD</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<p>CPD of smoke:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>smoke(0)</p></td>
<td><p>0.495455</p></td>
</tr>
<tr class="row-even"><td><p>smoke(1)</p></td>
<td><p>0.504545</p></td>
</tr>
</tbody>
</table>
<p>CPD of bronc:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>smoke</p></td>
<td><p>smoke(0)</p></td>
<td><p>smoke(1)</p></td>
</tr>
<tr class="row-even"><td><p>bronc(0)</p></td>
<td><p>0.6009174311926605</p></td>
<td><p>0.31675675675675674</p></td>
</tr>
<tr class="row-odd"><td><p>bronc(1)</p></td>
<td><p>0.39908256880733944</p></td>
<td><p>0.6832432432432433</p></td>
</tr>
</tbody>
</table>
<p>CPD of lung:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>smoke</p></td>
<td><p>smoke(0)</p></td>
<td><p>smoke(1)</p></td>
</tr>
<tr class="row-even"><td><p>lung(0)</p></td>
<td><p>0.138348623853211</p></td>
<td><p>0.05333333333333334</p></td>
</tr>
<tr class="row-odd"><td><p>lung(1)</p></td>
<td><p>0.861651376146789</p></td>
<td><p>0.9466666666666667</p></td>
</tr>
</tbody>
</table>
<p>CPD of dysp:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>bronc</p></td>
<td><p>bronc(0)</p></td>
<td><p>bronc(0)</p></td>
<td><p>bronc(1)</p></td>
<td><p>bronc(1)</p></td>
</tr>
<tr class="row-even"><td><p>either</p></td>
<td><p>either(0)</p></td>
<td><p>either(1)</p></td>
<td><p>either(0)</p></td>
<td><p>either(1)</p></td>
</tr>
<tr class="row-odd"><td><p>dysp(0)</p></td>
<td><p>0.7508090614886731</p></td>
<td><p>0.7821064552661382</p></td>
<td><p>0.6189591078066915</p></td>
<td><p>0.12156934978817462</p></td>
</tr>
<tr class="row-even"><td><p>dysp(1)</p></td>
<td><p>0.24919093851132687</p></td>
<td><p>0.21789354473386183</p></td>
<td><p>0.38104089219330856</p></td>
<td><p>0.8784306502118254</p></td>
</tr>
</tbody>
</table>
<p>CPD of either:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>lung</p></td>
<td><p>lung(0)</p></td>
<td><p>lung(0)</p></td>
<td><p>lung(1)</p></td>
<td><p>lung(1)</p></td>
</tr>
<tr class="row-even"><td><p>tub</p></td>
<td><p>tub(0)</p></td>
<td><p>tub(1)</p></td>
<td><p>tub(0)</p></td>
<td><p>tub(1)</p></td>
</tr>
<tr class="row-odd"><td><p>either(0)</p></td>
<td><p>0.5098039215686274</p></td>
<td><p>0.8427672955974843</p></td>
<td><p>0.648876404494382</p></td>
<td><p>0.01302897644361059</p></td>
</tr>
<tr class="row-even"><td><p>either(1)</p></td>
<td><p>0.49019607843137253</p></td>
<td><p>0.15723270440251572</p></td>
<td><p>0.351123595505618</p></td>
<td><p>0.9869710235563894</p></td>
</tr>
</tbody>
</table>
<p>CPD of tub:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>tub(0)</p></td>
<td><p>0.0555455</p></td>
</tr>
<tr class="row-even"><td><p>tub(1)</p></td>
<td><p>0.944455</p></td>
</tr>
</tbody>
</table>
<p>CPD of xray:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>either</p></td>
<td><p>either(0)</p></td>
<td><p>either(1)</p></td>
</tr>
<tr class="row-even"><td><p>xray(0)</p></td>
<td><p>0.7716262975778547</p></td>
<td><p>0.0750711093051605</p></td>
</tr>
<tr class="row-odd"><td><p>xray(1)</p></td>
<td><p>0.22837370242214533</p></td>
<td><p>0.9249288906948395</p></td>
</tr>
</tbody>
</table>
<p>From this point on we can start making inferences given the DAG and the CPDs. For demonstration purposes I will repeat question 4.</p>
<p><strong>Question</strong></p>
<p>What is the probability of lung-cancer or bronchitis, given that we know that patient does smoke but did <strong>not</strong> had xray?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">inference</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">DAG</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bronc&#39;</span><span class="p">,</span><span class="s1">&#39;lung&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;smoke&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;xray&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>lung</p></th>
<th class="head"><p>bronc</p></th>
<th class="head"><p>phi(lung,bronc)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>lung(0)</p></td>
<td><p>bronc(0)</p></td>
<td><p>0.0797</p></td>
</tr>
<tr class="row-odd"><td><p>lung(0)</p></td>
<td><p>bronc(1)</p></td>
<td><p>0.1720</p></td>
</tr>
<tr class="row-even"><td><p>lung(1)</p></td>
<td><p>bronc(0)</p></td>
<td><p>0.2370</p></td>
</tr>
<tr class="row-odd"><td><p>lung(1)</p></td>
<td><p>bronc(1)</p></td>
<td><p>0.5113</p></td>
</tr>
</tbody>
</table>
<p>The highest probability for the patient under these condition is that lung-cancer is true and bronchitus is true too (P=0.51).</p>
</section>
</section>
</section>
<section id="use-case-continuous-datasets">
<h1>Use Case Continuous Datasets<a class="headerlink" href="#use-case-continuous-datasets" title="Link to this heading"></a></h1>
<p>Bnlearn includes the LiNGAM-based methods which can model datasets with continuous variables but also hybrid datasets.
A disadvantage is that causal discovery of structure learning is the end-point when uing this method. It is not possible to perform parameter learning and inferences.
In the following example we will load the auto mpg dataset and learn the structure:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">bnlearn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">bn</span>

<span class="c1"># Load data set</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">import_example</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;auto_mpg&#39;</span><span class="p">)</span>
<span class="k">del</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;origin&#39;</span><span class="p">]</span>

<span class="c1"># Structure learning</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">structure_learning</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">methodtype</span><span class="o">=</span><span class="s1">&#39;direct-lingam&#39;</span><span class="p">)</span>

<span class="c1"># Compute edge strength</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">independence_test</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">prune</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">bn</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="c1"># Plot with graphviz</span>
<span class="n">dotgraph</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">plot_graphviz</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">dotgraph</span>
<span class="n">dotgraph</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;dotgraph_auto_mpg_lingam_direct&#39;</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils align-center">
<tbody>
<tr class="row-odd"><td><p><img alt="fig9a" src="_images/fig_auto_mpg_lingam_a.png" /></p></td>
</tr>
<tr class="row-even"><td><p><img alt="fig9b" src="_images/fig_auto_mpg_lingam_b.png" /></p></td>
</tr>
</tbody>
</table>
<hr>
<center>
        <script async src="https://media.ethicalads.io/media/client/ethicalads.min.js"></script>
        <!-- Show an image ad -->
        <!-- <div data-ea-publisher="erdogantgithubio" data-ea-type="image"></div> -->
        <div data-ea-publisher="erdogantgithubio" data-ea-type="image" data-ea-style="stickybox"></div>
</center>
<hr></section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Examples.html" class="btn btn-neutral float-left" title="Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="bnlearn.structure_learning.html" class="btn btn-neutral float-right" title="bnlearn.structure_learning" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Erdogan Taskesen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>