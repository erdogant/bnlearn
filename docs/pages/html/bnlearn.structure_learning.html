

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>bnlearn.structure_learning &mdash; bnlearn bnlearn documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=e0179649" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=441dd29d"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="bnlearn.parameter_learning" href="bnlearn.parameter_learning.html" />
    <link rel="prev" title="Titanic Dataset Analysis" href="UseCases.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            bnlearn
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Quickstart</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Quickstart.html">Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Discretizing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Discretizing.html">Discretizing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Discretizing.html#manual-discretization">Manual Discretization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Discretizing.html#automatic-discretization-probability-density">Automatic Discretization: Probability Density</a></li>
<li class="toctree-l1"><a class="reference internal" href="Discretizing.html#automatic-discretization-principled-bayesian">Automatic Discretization: Principled Bayesian</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Structure learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html">Causation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html#exhaustivesearch">Exhaustivesearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html#hillclimbsearch">Hillclimbsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html#chow-liu">Chow-liu</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html#tree-augmented-naive-bayes-tan">Tree-augmented Naive Bayes (TAN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html#naivebayes">NaiveBayes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html#constraint-based">Constraint-based</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parameter learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Parameter%20learning.html">Parameter learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Parameter%20learning.html#parameter-learning-examples">Parameter Learning Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="Parameter%20learning.html#conditional-probability-distributions-cpd">Conditional Probability Distributions (CPD)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Inference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Inference.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="Inference.html#inference-algorithms">Inference Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="Inference.html#examples-inference">Examples Inference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Continuous Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Continuous%20Data.html">Modelling Continuous Datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Predict</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Predict.html">Predict</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Sampling</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Sampling.html">Forward Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sampling.html#gibbs-sampling">Gibbs Sampling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Plot</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Plot.html">Plotting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other functionalities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="independence_test.html">Independence test</a></li>
<li class="toctree-l1"><a class="reference internal" href="Create%20DAG.html">Directed Acyclic Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="impute.html">Impute</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example%20Datasets.html">DataFrames</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example%20Datasets.html#import-dag-bif">Import DAG/BIF</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example%20Datasets.html#export-dag-bif">Export DAG/BIF</a></li>
<li class="toctree-l1"><a class="reference internal" href="whitelist_blacklist.html">Black and white lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="topological_sort.html">Topological sort</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataframe%20conversions.html">Data Conversions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure_scores.html">Structure Scores</a></li>
<li class="toctree-l1"><a class="reference internal" href="saving%20and%20loading.html">Saving and Loading</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html#working-with-raw-data">Working with Raw Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html#create-a-bayesian-network-learn-its-parameters-from-data-and-perform-the-inference">Create a Bayesian Network, learn its parameters from data and perform the inference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Use Cases</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="UseCases.html">Titanic Dataset Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="UseCases.html#medical-domain-analysis">Medical Domain Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="UseCases.html#use-case-continuous-datasets">Use Case Continuous Datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parameters and attributes</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">bnlearn.structure_learning</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#bnlearn.structure_learning.fit"><code class="docutils literal notranslate"><span class="pre">fit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bnlearn.parameter_learning.html">bnlearn.parameter_learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="bnlearn.inference.html">bnlearn.inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="bnlearn.bnlearn.html">bnlearn.bnlearn</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html">Documentation</a></li>
</ul>

    <a href= "genindex.html">Index</a>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">bnlearn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">bnlearn.structure_learning</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/bnlearn.structure_learning.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-bnlearn.structure_learning">
<span id="bnlearn-structure-learning"></span><h1>bnlearn.structure_learning<a class="headerlink" href="#module-bnlearn.structure_learning" title="Link to this heading"></a></h1>
<p>Structure learning. Given a set of data samples, estimate a DAG that captures the dependencies between the variables.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bnlearn.structure_learning.fit">
<span class="sig-prename descclassname"><span class="pre">bnlearn.structure_learning.</span></span><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">methodtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scoretype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">black_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">white_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw_list_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_indegree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tabu_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_all_dags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_lingam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'apply_prior_knowledge_softly':</span> <span class="pre">False,</span> <span class="pre">'measure':</span> <span class="pre">'pwling',</span> <span class="pre">'prior_knowledge':</span> <span class="pre">None,</span> <span class="pre">'random_state':</span> <span class="pre">None}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_pc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.05,</span> <span class="pre">'ci_test':</span> <span class="pre">'chi_square'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bnlearn.structure_learning.fit" title="Link to this definition"></a></dt>
<dd><p>Structure learning fit model.</p>
<p>Search strategies for structure learning
The search space of DAGs is super-exponential in the number of variables and the above scoring functions allow for local maxima.</p>
<dl class="simple">
<dt>To learn model structure (a DAG) from a data set, there are three broad techniques:</dt><dd><ol class="arabic simple">
<li><p>Score-based structure learning: using scoring functions as defined in scoretype and search strategy as defined in methodtype.</p></li>
<li><p>Constraint-based structure learning (PC): Using statistics such as chi-square test for strength of edges prior the modeling.</p></li>
<li><p>Hybrid structure learning (The combination of both techniques)</p></li>
</ol>
</dd>
</dl>
<section id="score-based-structure-learning">
<h2>Score-based Structure Learning<a class="headerlink" href="#score-based-structure-learning" title="Link to this heading"></a></h2>
<p>This approach performes model selection as an optimization task. It has two building blocks:
A scoring function sD:-&gt;R that maps models to a numerical score, based on how well they fit to a given data set D.
A search strategy to traverse the search space of possible models M and select a model with optimal score.
Commonly used scoring functions to measure the fit between model and data are Bayesian Dirichlet scores such as BDeu or K2 and the Bayesian Information Criterion (BIC, also called MDL).
BDeu is dependent on an equivalent sample size.</p>
<p>The BDs score is determined by adjusting certain settings based on the size of the dataset and the observed
variable counts. This adjustment involves using a value called “equivalent sample size” divided by the number of
parent configurations with observed variable counts. The score-method evaluates how effectively a model can describe the provided dataset.</p>
<p>The Direct-LiNGAM method or also named ‘direct-lingam’ is a semi-parametric approach that assumes a linear relationship among observed variables while ensuring that the error terms follow a non-Gaussian distribution, with the constraint that the graph remains acyclic.
Or in other words, the lingam-direct method allows you to model continuous and mixed datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">param df<span class="colon">:</span></dt>
<dd class="field-odd"><p>Input dataframe.</p>
</dd>
<dt class="field-even">type df<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame()</p>
</dd>
<dt class="field-odd">param methodtype<span class="colon">:</span></dt>
<dd class="field-odd"><p>String Search strategy for structure_learning.
# Constraintsearch
‘pc’ or ‘cs’ or ‘constraintsearch’
# Score-Based
‘ex’ or ‘exhaustivesearch’
‘hc’ or ‘hillclimbsearch’ (default)
# Score-Based: Requires Root Node
‘cl’ or ‘chow-liu’ (requires setting root_node parameter)
‘nb’ or ‘naivebayes’ (requires &lt;root_node&gt;)
‘tan’ (requires &lt;root_node&gt; and &lt;class_node&gt; parameter)
# Score-Based: For continuous and mixed datasets
‘direct-lingam’
‘ica-lingam’</p>
</dd>
<dt class="field-even">type methodtype<span class="colon">:</span></dt>
<dd class="field-even"><p>str, (default : ‘hc’)</p>
</dd>
<dt class="field-odd">param scoretype<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>Scoring function for the search spaces.</dt><dd><ul class="simple">
<li><p>‘bic’</p></li>
<li><p>‘k2’</p></li>
<li><p>‘bdeu’</p></li>
<li><p>‘bds’</p></li>
<li><p>‘aic’</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">type scoretype<span class="colon">:</span></dt>
<dd class="field-even"><p>str, (default : ‘bic’)</p>
</dd>
<dt class="field-odd">param black_list<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of edges are black listed.
In case of filtering on nodes, the nodes black listed nodes are removed from the dataframe. The resulting model will not contain any nodes that are in black_list.</p>
</dd>
<dt class="field-even">type black_list<span class="colon">:</span></dt>
<dd class="field-even"><p>List or None, (default : None)</p>
</dd>
<dt class="field-odd">param white_list<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of edges are white listed.
In case of filtering on nodes, the search is limited to those edges. The resulting model will then only contain nodes that are in white_list.
Works only in case of methodtype=’hc’ See also paramter: <cite>bw_list_method</cite></p>
</dd>
<dt class="field-even">type white_list<span class="colon">:</span></dt>
<dd class="field-even"><p>List or None, (default : None)</p>
</dd>
<dt class="field-odd">param bw_list_method<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>A list of edges can be passed as <cite>black_list</cite> or <cite>white_list</cite> to exclude or to limit the search.</dt><dd><ul class="simple">
<li><p>‘edges’ : [(‘A’, ‘B’), (‘C’,’D’), (…)] This option is limited to only methodtype=’hc’</p></li>
<li><p>‘nodes’ : [‘A’, ‘B’, …] Filter the dataframe based on the nodes for <cite>black_list</cite> or <cite>white_list</cite>. Filtering can be done for every methodtype/scoretype.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">type bw_list_method<span class="colon">:</span></dt>
<dd class="field-even"><p>list of str or tuple, (default : None)</p>
</dd>
<dt class="field-odd">param max_indegree<span class="colon">:</span></dt>
<dd class="field-odd"><p>If provided and unequal None, the procedure only searches among models where all nodes have at most max_indegree parents. (only in case of methodtype=’hc’)</p>
</dd>
<dt class="field-even">type max_indegree<span class="colon">:</span></dt>
<dd class="field-even"><p>int, (default : None)</p>
</dd>
<dt class="field-odd">param epsilon<span class="colon">:</span></dt>
<dd class="field-odd"><p>Defines the exit condition. If the improvement in score is less than <cite>epsilon</cite>, the learned model is returned. (only in case of methodtype=’hc’)</p>
</dd>
<dt class="field-even">type epsilon<span class="colon">:</span></dt>
<dd class="field-even"><p>float (default: 1e-4)</p>
</dd>
<dt class="field-odd">param max_iter<span class="colon">:</span></dt>
<dd class="field-odd"><p>The maximum number of iterations allowed. Returns the learned model when the number of iterations is greater than <cite>max_iter</cite>. (only in case of methodtype=’hc’)</p>
</dd>
<dt class="field-even">type max_iter<span class="colon">:</span></dt>
<dd class="field-even"><p>int (default: 1e6)</p>
</dd>
<dt class="field-odd">param root_node<span class="colon">:</span></dt>
<dd class="field-odd"><p>The root node for treeSearch based methods.</p>
</dd>
<dt class="field-even">type root_node<span class="colon">:</span></dt>
<dd class="field-even"><p>String. (only in case of chow-liu, Tree-augmented Naive Bayes (TAN))</p>
</dd>
<dt class="field-odd">param class_node<span class="colon">:</span></dt>
<dd class="field-odd"><p>The class node is required for Tree-augmented Naive Bayes (TAN)</p>
</dd>
<dt class="field-even">type class_node<span class="colon">:</span></dt>
<dd class="field-even"><p>String</p>
</dd>
<dt class="field-odd">param fixed_edges<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of edges that will always be there in the final learned model. The algorithm will add these edges at the start of the algorithm and will never change it.</p>
</dd>
<dt class="field-even">type fixed_edges<span class="colon">:</span></dt>
<dd class="field-even"><p>iterable, Only in case of HillClimbSearch.</p>
</dd>
<dt class="field-odd">param return_all_dags<span class="colon">:</span></dt>
<dd class="field-odd"><p>True: Return all possible DAGs. Only in case methodtype=’exhaustivesearch’
False: Do not return DAGs</p>
</dd>
<dt class="field-even">type return_all_dags<span class="colon">:</span></dt>
<dd class="field-even"><p>Bool, (default: False)</p>
</dd>
<dt class="field-odd">param params_lingam<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>prior_knowledge<span class="classifier">array-like, shape (n_features, n_features), optional (default=None)</span></dt><dd><p>Prior knowledge used for causal discovery, where <code class="docutils literal notranslate"><span class="pre">n_features</span></code> is the number of features.</p>
</dd>
<dt>apply_prior_knowledge_softly<span class="classifier">boolean, optional (default=False)</span></dt><dd><p>If True, apply prior knowledge softly.</p>
</dd>
<dt>measure<span class="classifier">String: (default=’pwling’)</span></dt><dd><p>For fast execution with GPU, ‘pwling_fast’ can be used (culingam is required).
‘pwling’, ‘kernel’, ‘pwling_fast’</p>
</dd>
</dl>
</dd>
<dt class="field-even">type params_lingam<span class="colon">:</span></dt>
<dd class="field-even"><p>dict: {‘random_state’: None, ‘prior_knowledge’: None, ‘apply_prior_knowledge_softly’: False, ‘measure’: ‘pwling’}</p>
</dd>
<dt class="field-odd">param params_pc<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>‘ci_test’: ‘chi_square’, ‘pearsonr’, ‘g_sq’, ‘log_likelihood’, ‘freeman_tuckey’, ‘modified_log_likelihood’, ‘neyman’, ‘cressie_read’, ‘power_divergence’</p></li>
<li><p>‘alpha’: 0.05</p></li>
</ul>
</dd>
<dt class="field-even">type params_pc<span class="colon">:</span></dt>
<dd class="field-even"><p>dict: {‘ci_test’: ‘chi_square’, ‘alpha’: 0.05}</p>
</dd>
<dt class="field-odd">param verbose<span class="colon">:</span></dt>
<dd class="field-odd"><p>0: None, 1: Error,  2: Warning, 3: Info (default), 4: Debug, 5: Trace</p>
</dd>
<dt class="field-even">type verbose<span class="colon">:</span></dt>
<dd class="field-even"><p>int, (default : 3)</p>
</dd>
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>‘model’ : pgmpy model
‘model_edges’ : Edges
‘adjmat’ : Adjacency matrix
‘config’ : Configurations
‘structure_scores’ : Structure scores (the lower the better)</p>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>dict with keys</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Import bnlearn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">bnlearn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">bn</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load DAG</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">import_DAG</span><span class="p">(</span><span class="s1">&#39;asia&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># plot ground truth</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Sampling example</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load DAG</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">import_DAG</span><span class="p">(</span><span class="s1">&#39;asia&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Sampling</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">sampling</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Structure learning of sampled dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_sl</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">structure_learning</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">methodtype</span><span class="o">=</span><span class="s1">&#39;hc&#39;</span><span class="p">,</span> <span class="n">scoretype</span><span class="o">=</span><span class="s1">&#39;bic&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute edge strength using chi-square independence test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_sl</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">independence_test</span><span class="p">(</span><span class="n">model_sl</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot based on structure learning of sampled data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bn</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model_sl</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="s1">&#39;pos&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compare networks and make plot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bn</span><span class="o">.</span><span class="n">compare_networks</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">model_sl</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="s1">&#39;pos&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Model mixed data sets (both discrete and continuous variables)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load DAG</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">import_example</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;auto_mpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Structure learning of sampled dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">structure_learning</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">methodtype</span><span class="o">=</span><span class="s1">&#39;direct-lingam&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute edge strength using chi-square independence test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">independence_test</span><span class="p">(</span><span class="n">model_sl</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot based on structure learning of sampled data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bn</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model_sl</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="s1">&#39;pos&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><p>[1] Scutari, Marco. An Empirical-Bayes Score for Discrete Bayesian Networks. Journal of Machine Learning Research, 2016, pp. 438–48</p></li>
<li><p>[2] Shimizu et al, DirectLiNGAM: A direct method for learning a linear non-Gaussian structural equation model, <a class="reference external" href="https://arxiv.org/abs/1101.2489v3">https://arxiv.org/abs/1101.2489v3</a></p></li>
</ul>
</section>
</dd></dl>

<hr>
<center>
        <script async src="https://media.ethicalads.io/media/client/ethicalads.min.js"></script>
        <!-- Show an image ad -->
        <!-- <div data-ea-publisher="erdogantgithubio" data-ea-type="image"></div> -->
        <div data-ea-publisher="erdogantgithubio" data-ea-type="image" data-ea-style="stickybox"></div>
</center>
<hr></section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="UseCases.html" class="btn btn-neutral float-left" title="Titanic Dataset Analysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="bnlearn.parameter_learning.html" class="btn btn-neutral float-right" title="bnlearn.parameter_learning" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Erdogan Taskesen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>