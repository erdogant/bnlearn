

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Parameter learning &mdash; bnlearn bnlearn documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=e0179649" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=441dd29d"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Inference" href="Inference.html" />
    <link rel="prev" title="Causation" href="Structure%20learning.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            bnlearn
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Quickstart</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Quickstart.html">Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Install from Pypi (pip)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html#install-from-github">Install from github</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html#create-environment">Create environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html#uninstall">Uninstall</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html#validate">Validate</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html#import-error">Import Error</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Discretizing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Discretizing.html">Discretizing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Discretizing.html#discretize-manually">Discretize manually</a></li>
<li class="toctree-l1"><a class="reference internal" href="Discretizing.html#discretize-automatically-probability-density">Discretize Automatically: Probability Density</a></li>
<li class="toctree-l1"><a class="reference internal" href="Discretizing.html#discretize-automatically-principled-bayesian">Discretize Automatically: Principled Bayesian</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Structure learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html">Causation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html#exhaustivesearch">Exhaustivesearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html#hillclimbsearch">Hillclimbsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html#chow-liu">Chow-liu</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html#tree-augmented-naive-bayes-tan">Tree-augmented Naive Bayes (TAN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html#naivebayes">NaiveBayes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure%20learning.html#constraint-based">Constraint-based</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parameter learning</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Parameter learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="#maximum-likelihood-estimation">Maximum Likelihood Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="#bayesian-parameter-estimation">Bayesian Parameter Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="#examples-parameter-learning">Examples Parameter learning</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#example-1">Example (1)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-2">Example (2)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#conditional-probability-distributions-cpd">Conditional Probability Distributions (CPD)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Inference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Inference.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="Inference.html#inference-algorithms">Inference Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="Inference.html#examples-inference">Examples Inference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Continuous Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Continuous%20Data.html">Modelling Continuous Datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Predict</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Predict.html">Predict</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Sampling</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Sampling.html">Forward Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sampling.html#gibbs-sampling">Gibbs Sampling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Plot</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Plot.html">Interactive plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plot.html#static-plot-networkx">Static plot (networkx)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plot.html#static-plot-graphviz">Static plot (graphviz)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plot.html#comparison-of-two-networks">Comparison of two networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plot.html#node-properties">Node properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plot.html#edge-properties">Edge properties</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other functionalities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="independence_test.html">Independence test</a></li>
<li class="toctree-l1"><a class="reference internal" href="Create%20DAG.html">Directed Acyclic Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="impute.html">Impute</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example%20Datasets.html">DataFrames</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example%20Datasets.html#import-dag-bif">Import DAG/BIF</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example%20Datasets.html#export-dag-bif">Export DAG/BIF</a></li>
<li class="toctree-l1"><a class="reference internal" href="whitelist_blacklist.html">Black and white lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="topological_sort.html">Topological sort</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataframe%20conversions.html">Data Conversions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Structure_scores.html">Structure Scores</a></li>
<li class="toctree-l1"><a class="reference internal" href="saving%20and%20loading.html">Saving and Loading</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">Start with RAW data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html#structure-learning">Structure learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html#parameter-learning">Parameter learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html#create-a-bayesian-network-learn-its-parameters-from-data-and-perform-the-inference">Create a Bayesian Network, learn its parameters from data and perform the inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="UseCases.html">Use Case Titanic</a></li>
<li class="toctree-l1"><a class="reference internal" href="UseCases.html#use-case-medical-domain">Use Case Medical domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="UseCases.html#use-case-continuous-datasets">Use Case Continuous Datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parameters and attributes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="bnlearn.structure_learning.html">bnlearn.structure_learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="bnlearn.parameter_learning.html">bnlearn.parameter_learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="bnlearn.inference.html">bnlearn.inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="bnlearn.bnlearn.html">bnlearn.bnlearn</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html">Sponsor</a></li>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html#medium-blog">Medium Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html#github">Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html#colab-notebook">Colab Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html#citing">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html#references">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="Documentation.html#related-packages">Related Packages</a></li>
</ul>

    <a href= "genindex.html">Index</a>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">bnlearn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Parameter learning</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Parameter learning.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="parameter-learning">
<h1>Parameter learning<a class="headerlink" href="#parameter-learning" title="Link to this heading"></a></h1>
<p>Parameter learning is the task to estimate the values of the conditional probability distributions (CPDs).
To make sense of the given data, we can start by counting how often each state of the variable occurs.
If the variable is dependent on the parents, the counts are done conditionally on the parents states,
i.e. for seperately for each parent configuration.</p>
<p>Currently, the library supports Parameter learning for <em>discrete</em> nodes:</p>
<blockquote>
<div><ul class="simple">
<li><p>Maximum Likelihood Estimation</p></li>
<li><p>Bayesian Estimation</p></li>
</ul>
</div></blockquote>
</section>
<section id="maximum-likelihood-estimation">
<h1>Maximum Likelihood Estimation<a class="headerlink" href="#maximum-likelihood-estimation" title="Link to this heading"></a></h1>
<p>A natural estimate for the CPDs is to simply use the <em>relative frequencies</em>, with which the variable states have occured.</p>
<p>While very straightforward, the ML estimator has the problem of <em>overfitting</em> to the data.
If the observed data is not representative for the underlying distribution, ML estimations will be extremly far off.
When estimating parameters for Bayesian networks, lack of data is a frequent problem.
Even if the total sample size is very large, the fact that state counts are done conditionally for each parents configuration causes immense fragmentation.
If a variable has 3 parents that can each take 10 states, then state counts will be done seperately for <cite>10^3 = 1000</cite> parents configurations.
This makes MLE very fragile and unstable for learning Bayesian Network parameters.
A way to mitigate MLE’s overfitting is <em>Bayesian Parameter Estimation</em>.</p>
</section>
<section id="bayesian-parameter-estimation">
<h1>Bayesian Parameter Estimation<a class="headerlink" href="#bayesian-parameter-estimation" title="Link to this heading"></a></h1>
<p>The Bayesian Parameter Estimator starts with already existing prior CPDs, that express our beliefs about the variables <em>before</em> the data was observed.
Those “priors” are then updated, using the state counts from the observed data.</p>
<p>One can think of the priors as consisting in <em>pseudo state counts</em>, that are added to the actual counts before normalization. Unless one wants to encode specific beliefs
about the distributions of the variables, one commonly chooses uniform priors, i.e. ones that deem all states equiprobable.</p>
<p>A very simple prior is the so-called <em>K2</em> prior, which simply adds “1” to the count of every single state.
A somewhat more sensible choice of prior is <em>BDeu</em> (Bayesian Dirichlet equivalent uniform prior).
For BDeu we need to specify an <em>equivalent sample size</em> “N” and then the pseudo-counts are the equivalent of having observed <cite>N</cite> uniform samples of each variable (and each parent configuration).</p>
</section>
<section id="examples-parameter-learning">
<h1>Examples Parameter learning<a class="headerlink" href="#examples-parameter-learning" title="Link to this heading"></a></h1>
<section id="example-1">
<h2>Example (1)<a class="headerlink" href="#example-1" title="Link to this heading"></a></h2>
<p>For this example, we will be investigating the sprinkler data set. This is a very simple data set with 4 variables and each variable can contain value [1] or [0].
The question we can ask: What are the parameters for the DAG given a dataset? Note that his data set is already pre-processed and no missing values are present.
We need both a directed acycle graph (DAG) and dataset with the same variables. The idea is to link the dataset with the DAG.</p>
<p>Let’s bring in our dataset.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">bnlearn</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">bnlearn</span><span class="o">.</span><span class="n">import_example</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Cloudy</p></th>
<th class="head"><p>Sprinkler</p></th>
<th class="head"><p>Rain</p></th>
<th class="head"><p>Wet_Grass</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-even"><td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DAG</span> <span class="o">=</span> <span class="n">bnlearn</span><span class="o">.</span><span class="n">import_DAG</span><span class="p">(</span><span class="s1">&#39;sprinkler&#39;</span><span class="p">,</span> <span class="n">CPD</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DAG</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Cloudy</p></th>
<th class="head"><p>Sprinkler</p></th>
<th class="head"><p>Rain</p></th>
<th class="head"><p>Wet_Grass</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Cloudy</p></td>
<td><p>False</p></td>
<td><p>True</p></td>
<td><p>True</p></td>
<td><p>False</p></td>
</tr>
<tr class="row-odd"><td><p>Sprinkler</p></td>
<td><p>False</p></td>
<td><p>False</p></td>
<td><p>False</p></td>
<td><p>True</p></td>
</tr>
<tr class="row-even"><td><p>Rain</p></td>
<td><p>False</p></td>
<td><p>False</p></td>
<td><p>False</p></td>
<td><p>True</p></td>
</tr>
<tr class="row-odd"><td><p>Wet_Grass</p></td>
<td><p>False</p></td>
<td><p>False</p></td>
<td><p>False</p></td>
<td><p>False</p></td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bnlearn</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">DAG</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id1">
<span id="fig-pl"></span><img alt="_images/fig_sprinkler_sl.png" src="_images/fig_sprinkler_sl.png" />
<figcaption>
<p><span class="caption-text">DAG of the Sprinkler data set.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Suppose we observed <strong>N</strong> “cloudy” occurences among a total of “all clouds”, so we might guess that about “50%” of “cloudy” are “sprinkler” or so.
According to MLE, we should fill the CPDs in such a way, that P(data|model) is maximal. This is achieved when using the <em>relative frequencies</em>.
From the <em>bnlearn</em> library, we’ll need the <a class="reference internal" href="bnlearn.parameter_learning.html#bnlearn.parameter_learning.fit" title="bnlearn.parameter_learning.fit"><code class="xref py py-class docutils literal notranslate"><span class="pre">fit</span></code></a> for this exercise:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DAG_update</span> <span class="o">=</span> <span class="n">bnlearn</span><span class="o">.</span><span class="n">parameter_learning</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">DAG</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<dl>
<dt>CPD of Cloudy:</dt><dd><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Cloudy(0)</p></th>
<th class="head"><p>0.494</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Cloudy(1)</p></td>
<td><p>0.506</p></td>
</tr>
</tbody>
</table>
</dd>
<dt>CPD of Sprinkler:</dt><dd><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Cloudy</p></th>
<th class="head"><p>Cloudy(0)</p></th>
<th class="head"><p>Cloudy(1)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Sprinkler(0)</p></td>
<td><p>0.48</p></td>
<td><p>0.70</p></td>
</tr>
<tr class="row-odd"><td><p>Sprinkler(1)</p></td>
<td><p>0.51</p></td>
<td><p>0.29</p></td>
</tr>
</tbody>
</table>
</dd>
<dt>CPD of Rain:</dt><dd><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Cloudy</p></th>
<th class="head"><p>Cloudy(0)</p></th>
<th class="head"><p>Cloudy(1)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Rain(0)</p></td>
<td><p>0.65</p></td>
<td><p>0.33</p></td>
</tr>
<tr class="row-odd"><td><p>Rain(1)</p></td>
<td><p>0.34</p></td>
<td><p>0.66</p></td>
</tr>
</tbody>
</table>
</dd>
<dt>CPD of Wet_Grass:</dt><dd><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Rain</p></th>
<th class="head"><p>Rain(0)</p></th>
<th class="head"><p>Rain(0)</p></th>
<th class="head"><p>Rain(1)</p></th>
<th class="head"><p>Rain(1)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Sprinkler</p></td>
<td><p>Sprinkler(0)</p></td>
<td><p>Sprinkler(1)</p></td>
<td><p>Sprinkler(0)</p></td>
<td><p>Sprinkler(1)</p></td>
</tr>
<tr class="row-odd"><td><p>Wet_Grass(0)</p></td>
<td><p>0.75</p></td>
<td><p>0.33</p></td>
<td><p>0.25</p></td>
<td><p>0.37</p></td>
</tr>
<tr class="row-even"><td><p>Wet_Grass(1)</p></td>
<td><p>0.24</p></td>
<td><p>0.66</p></td>
<td><p>0.74</p></td>
<td><p>0.62</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<p>Great! We have the probabilities! Lets check how much they differ from the truth.
In general it can be seen that the estimated values are not very close at every point to the true values.
The main reason is because the dataframe only contains 1000 samples.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DAG_true</span> <span class="o">=</span> <span class="n">bnlearn</span><span class="o">.</span><span class="n">import_DAG</span><span class="p">(</span><span class="s1">&#39;sprinkler&#39;</span><span class="p">,</span> <span class="n">CPD</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<dl>
<dt>CPD of Cloudy:</dt><dd><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Cloudy(0)</p></td>
<td><p>0.5</p></td>
</tr>
<tr class="row-even"><td><p>Cloudy(1)</p></td>
<td><p>0.5</p></td>
</tr>
</tbody>
</table>
</dd>
<dt>CPD of Sprinkler:</dt><dd><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Cloudy</p></td>
<td><p>Cloudy(0)</p></td>
<td><p>Cloudy(1)</p></td>
</tr>
<tr class="row-even"><td><p>Sprinkler(0)</p></td>
<td><p>0.5</p></td>
<td><p>0.9</p></td>
</tr>
<tr class="row-odd"><td><p>Sprinkler(1)</p></td>
<td><p>0.5</p></td>
<td><p>0.1</p></td>
</tr>
</tbody>
</table>
</dd>
<dt>CPD of Rain:</dt><dd><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Cloudy</p></td>
<td><p>Cloudy(0)</p></td>
<td><p>Cloudy(1)</p></td>
</tr>
<tr class="row-even"><td><p>Rain(0)</p></td>
<td><p>0.8</p></td>
<td><p>0.2</p></td>
</tr>
<tr class="row-odd"><td><p>Rain(1)</p></td>
<td><p>0.2</p></td>
<td><p>0.8</p></td>
</tr>
</tbody>
</table>
</dd>
<dt>CPD of Wet_Grass:</dt><dd><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Sprinkler</p></td>
<td><p>Sprinkler(0)</p></td>
<td><p>Sprinkler(0)</p></td>
<td><p>Sprinkler(1)</p></td>
<td><p>Sprinkler(1)</p></td>
</tr>
<tr class="row-even"><td><p>Rain</p></td>
<td><p>Rain(0)</p></td>
<td><p>Rain(1)</p></td>
<td><p>Rain(0)</p></td>
<td><p>Rain(1)</p></td>
</tr>
<tr class="row-odd"><td><p>Wet_Grass(0)</p></td>
<td><p>1.0</p></td>
<td><p>0.1</p></td>
<td><p>0.1</p></td>
<td><p>0.01</p></td>
</tr>
<tr class="row-even"><td><p>Wet_Grass(1)</p></td>
<td><p>0.0</p></td>
<td><p>0.9</p></td>
<td><p>0.9</p></td>
<td><p>0.99</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<p>Lets generate more samples and learn again the parameters. You will see that these results are much closer to the true values.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">bnlearn</span><span class="o">.</span><span class="n">sampling</span><span class="p">(</span><span class="n">DAG</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">DAG_update</span> <span class="o">=</span> <span class="n">bnlearn</span><span class="o">.</span><span class="n">parameter_learning</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">DAG</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="example-2">
<h2>Example (2)<a class="headerlink" href="#example-2" title="Link to this heading"></a></h2>
<p>Lets try out a more complexer model. We need both a directed acycle graph (DAG) and dataset with the same variables.
So again, the idea is to link the dataset with the DAG.</p>
<p>Let’s bring in the <strong>asia</strong> dataset.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">bnlearn</span>

<span class="c1"># Load asia data set</span>
<span class="n">DAG</span> <span class="o">=</span> <span class="n">bnlearn</span><span class="o">.</span><span class="n">import_DAG</span><span class="p">(</span><span class="s1">&#39;asia&#39;</span><span class="p">)</span>
<span class="c1"># Plot</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">bnlearn</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">DAG</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id2">
<img alt="_images/fig2a_asia_groundtruth.png" src="_images/fig2a_asia_groundtruth.png" />
<figcaption>
<p><span class="caption-text">DAG of the Asia data set.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate samples</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">bnlearn</span><span class="o">.</span><span class="n">sampling</span><span class="p">(</span><span class="n">DAG</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="c1"># Learn parameters</span>
<span class="n">DAG_update</span> <span class="o">=</span> <span class="n">bnlearn</span><span class="o">.</span><span class="n">parameter_learning</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">DAG</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<p>This DAG is now updated with parameters which is great because it opens many possibilities in terms of inference or you can start sampling any number of samples you desire.</p>
<dl>
<dt>CPD of asia:</dt><dd><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>asia(0)</p></td>
<td><p>0.055</p></td>
</tr>
<tr class="row-even"><td><p>asia(1)</p></td>
<td><p>0.944</p></td>
</tr>
</tbody>
</table>
</dd>
<dt>CPD of bronc:</dt><dd><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>smoke</p></td>
<td><p>smoke(0)</p></td>
<td><p>smoke(1)</p></td>
</tr>
<tr class="row-even"><td><p>bronc(0)</p></td>
<td><p>0.585</p></td>
<td><p>0.319</p></td>
</tr>
<tr class="row-odd"><td><p>bronc(1)</p></td>
<td><p>0.414</p></td>
<td><p>0.680</p></td>
</tr>
</tbody>
</table>
</dd>
<dt>CPD of dysp:</dt><dd><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>bronc</p></td>
<td><p>bronc(0)</p></td>
<td><p>bronc(0)</p></td>
<td><p>bronc(1)</p></td>
<td><p>bronc(1)</p></td>
</tr>
<tr class="row-even"><td><p>either</p></td>
<td><p>either(0)</p></td>
<td><p>either(1)</p></td>
<td><p>either(0)</p></td>
<td><p>either(1)</p></td>
</tr>
<tr class="row-odd"><td><p>dysp(0)</p></td>
<td><p>0.714</p></td>
<td><p>0.787</p></td>
<td><p>0.586</p></td>
<td><p>0.123</p></td>
</tr>
<tr class="row-even"><td><p>dysp(1)</p></td>
<td><p>0.285</p></td>
<td><p>0.212</p></td>
<td><p>0.413</p></td>
<td><p>0.876</p></td>
</tr>
</tbody>
</table>
</dd>
<dt>CPD of either:</dt><dd><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>lung</p></td>
<td><p>lung(0)</p></td>
<td><p>lung(0)</p></td>
<td><p>lung(1)</p></td>
<td><p>lung(1)</p></td>
</tr>
<tr class="row-even"><td><p>tub</p></td>
<td><p>tub(0)</p></td>
<td><p>tub(1)</p></td>
<td><p>tub(0)</p></td>
<td><p>tub(1)</p></td>
</tr>
<tr class="row-odd"><td><p>either(0)</p></td>
<td><p>0.507</p></td>
<td><p>0.837</p></td>
<td><p>0.642</p></td>
<td><p>0.012</p></td>
</tr>
<tr class="row-even"><td><p>either(1)</p></td>
<td><p>0.492</p></td>
<td><p>0.1625</p></td>
<td><p>0.357</p></td>
<td><p>0.987</p></td>
</tr>
</tbody>
</table>
</dd>
<dt>CPD of lung:</dt><dd><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>smoke</p></td>
<td><p>smoke(0)</p></td>
<td><p>smoke(1)</p></td>
</tr>
<tr class="row-even"><td><p>lung(0)</p></td>
<td><p>0.132</p></td>
<td><p>0.0537</p></td>
</tr>
<tr class="row-odd"><td><p>lung(1)</p></td>
<td><p>0.867</p></td>
<td><p>0.9462</p></td>
</tr>
</tbody>
</table>
</dd>
<dt>CPD of smoke:</dt><dd><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>smoke(0)</p></td>
<td><p>0.498</p></td>
</tr>
<tr class="row-even"><td><p>smoke(1)</p></td>
<td><p>0.501</p></td>
</tr>
</tbody>
</table>
</dd>
<dt>CPD of tub:</dt><dd><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>asia</p></td>
<td><p>asia(0)</p></td>
<td><p>asia(1)</p></td>
</tr>
<tr class="row-even"><td><p>tub(0)</p></td>
<td><p>0.418</p></td>
<td><p>0.0336</p></td>
</tr>
<tr class="row-odd"><td><p>tub(1)</p></td>
<td><p>0.581</p></td>
<td><p>0.9663</p></td>
</tr>
</tbody>
</table>
</dd>
<dt>CPD of xray:</dt><dd><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>either</p></td>
<td><p>either(0)</p></td>
<td><p>either(1)</p></td>
</tr>
<tr class="row-even"><td><p>xray(0)</p></td>
<td><p>0.7693</p></td>
<td><p>0.070</p></td>
</tr>
<tr class="row-odd"><td><p>xray(1)</p></td>
<td><p>0.230</p></td>
<td><p>0.929</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</section>
</section>
<section id="conditional-probability-distributions-cpd">
<h1>Conditional Probability Distributions (CPD)<a class="headerlink" href="#conditional-probability-distributions-cpd" title="Link to this heading"></a></h1>
<p>The <strong>Conditional Probabilistic Tables (CPTs)</strong> or Conditional Probability Distributions (CPD) quantitatively describe the statistical relationship between each node and its parents, and can be computed using Parameter learning as shown in the examples.
In the following example I will show how to extract the CPDs from a model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import library</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">bnlearn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">bn</span>

<span class="c1"># Import one of the example models</span>
<span class="c1"># sprinkler&#39;, &#39;alarm&#39;, &#39;andes&#39;, &#39;asia&#39;, &#39;sachs&#39;, &#39;filepath/to/model.bif&#39;,</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">import_DAG</span><span class="p">(</span><span class="s1">&#39;asia&#39;</span><span class="p">,</span> <span class="n">CPD</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Print the CPD for the model</span>
<span class="n">CPDs</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">print_CPD</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="c1"># Deeper investigate the CPDs</span>
<span class="n">CPDs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="c1"># dict_keys([&#39;asia&#39;, &#39;bronc&#39;, &#39;dysp&#39;, &#39;either&#39;, &#39;lung&#39;, &#39;smoke&#39;, &#39;tub&#39;, &#39;xray&#39;])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">CPDs</span><span class="p">[</span><span class="s1">&#39;smoke&#39;</span><span class="p">])</span>
<span class="c1">#    smoke    p</span>
<span class="c1"># 0      0  0.5</span>
<span class="c1"># 1      1  0.5</span>
</pre></div>
</div>
<hr>
<center>
        <script async src="https://media.ethicalads.io/media/client/ethicalads.min.js"></script>
        <!-- Show an image ad -->
        <!-- <div data-ea-publisher="erdogantgithubio" data-ea-type="image"></div> -->
        <div data-ea-publisher="erdogantgithubio" data-ea-type="image" data-ea-style="stickybox"></div>
</center>
<hr></section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Structure%20learning.html" class="btn btn-neutral float-left" title="Causation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Inference.html" class="btn btn-neutral float-right" title="Inference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Erdogan Taskesen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>